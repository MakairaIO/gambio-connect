'use strict';

var btnExport = document.querySelector('.export button');
var btnReplace = document.querySelector('.replace button');
var btnSwitch = document.querySelector('.switch button');
var successKey = 'gx-admin:send-info-box-success-message';
var warningKey = 'gx-admin:send-info-box-warning-message';

function handleClick(event, callbackUrl) {
	var btn = event.target;
	var request = fetch(callbackUrl, {
		method: 'post'
	});
	btn.setAttribute('disabled', true);

	request.then(function (response) {
		if (response.ok) {
			window.dispatchEvent(new Event(successKey));
		} else {
			window.dispatchEvent(new CustomEvent(warningKey, {
				detail: {
					title: 'Request failed',
					message: 'Could not perform requested action.'
				}
			}));
		}
	}).finally(function () {
		btn.removeAttribute('disabled');
	});
}

function addCallbackListener(button, callbackUrl) {
	button.addEventListener('click', function (event) {
		handleClick(event, callbackUrl);
	});
}

addCallbackListener(btnExport, window.jsEnvironment.baseUrl + '/admin/makaira/gambio-connect/sync/export');
addCallbackListener(btnReplace, window.jsEnvironment.baseUrl + '/admin/makaira/gambio-connect/sync/replace');
addCallbackListener(btnSwitch, window.jsEnvironment.baseUrl + '/admin/makaira/gambio-connect/sync/switch');
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVpL2Fzc2V0cy9vdmVydmlldy5qcyJdLCJuYW1lcyI6WyJidG5FeHBvcnQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJidG5SZXBsYWNlIiwiYnRuU3dpdGNoIiwic3VjY2Vzc0tleSIsIndhcm5pbmdLZXkiLCJoYW5kbGVDbGljayIsImV2ZW50IiwiY2FsbGJhY2tVcmwiLCJidG4iLCJ0YXJnZXQiLCJyZXF1ZXN0IiwiZmV0Y2giLCJtZXRob2QiLCJzZXRBdHRyaWJ1dGUiLCJ0aGVuIiwicmVzcG9uc2UiLCJvayIsIndpbmRvdyIsImRpc3BhdGNoRXZlbnQiLCJFdmVudCIsIkN1c3RvbUV2ZW50IiwiZGV0YWlsIiwidGl0bGUiLCJtZXNzYWdlIiwiZmluYWxseSIsInJlbW92ZUF0dHJpYnV0ZSIsImFkZENhbGxiYWNrTGlzdGVuZXIiLCJidXR0b24iLCJhZGRFdmVudExpc3RlbmVyIiwianNFbnZpcm9ubWVudCIsImJhc2VVcmwiXSwibWFwcGluZ3MiOiI7O0FBQUEsSUFBTUEsWUFBWUMsU0FBU0MsYUFBVCxDQUF1QixnQkFBdkIsQ0FBbEI7QUFDQSxJQUFNQyxhQUFhRixTQUFTQyxhQUFULENBQXVCLGlCQUF2QixDQUFuQjtBQUNBLElBQU1FLFlBQVlILFNBQVNDLGFBQVQsQ0FBdUIsZ0JBQXZCLENBQWxCO0FBQ0EsSUFBTUcsYUFBYSx3Q0FBbkI7QUFDQSxJQUFNQyxhQUFhLHdDQUFuQjs7QUFFQSxTQUFTQyxXQUFULENBQXFCQyxLQUFyQixFQUE0QkMsV0FBNUIsRUFBeUM7QUFDeEMsS0FBTUMsTUFBTUYsTUFBTUcsTUFBbEI7QUFDQSxLQUFNQyxVQUFVQyxNQUFNSixXQUFOLEVBQW1CO0FBQ2xDSyxVQUFRO0FBRDBCLEVBQW5CLENBQWhCO0FBR0FKLEtBQUlLLFlBQUosQ0FBaUIsVUFBakIsRUFBNkIsSUFBN0I7O0FBRUFILFNBQVFJLElBQVIsQ0FBYSxvQkFBWTtBQUN4QixNQUFJQyxTQUFTQyxFQUFiLEVBQWlCO0FBQ2hCQyxVQUFPQyxhQUFQLENBQXFCLElBQUlDLEtBQUosQ0FBVWhCLFVBQVYsQ0FBckI7QUFDQSxHQUZELE1BRU87QUFDTmMsVUFBT0MsYUFBUCxDQUFxQixJQUFJRSxXQUFKLENBQWdCaEIsVUFBaEIsRUFBNEI7QUFDaERpQixZQUFRO0FBQ1BDLFlBQU8sZ0JBREE7QUFFUEMsY0FBUztBQUZGO0FBRHdDLElBQTVCLENBQXJCO0FBTUE7QUFDRCxFQVhELEVBV0dDLE9BWEgsQ0FXVyxZQUFNO0FBQ2hCaEIsTUFBSWlCLGVBQUosQ0FBb0IsVUFBcEI7QUFDQSxFQWJEO0FBY0E7O0FBRUQsU0FBU0MsbUJBQVQsQ0FBNkJDLE1BQTdCLEVBQXFDcEIsV0FBckMsRUFBa0Q7QUFDakRvQixRQUFPQyxnQkFBUCxDQUF3QixPQUF4QixFQUFpQyxpQkFBUztBQUN6Q3ZCLGNBQVlDLEtBQVosRUFBbUJDLFdBQW5CO0FBQ0EsRUFGRDtBQUdBOztBQUVEbUIsb0JBQW9CNUIsU0FBcEIsRUFBa0NtQixPQUFPWSxhQUFQLENBQXFCQyxPQUF2RDtBQUNBSixvQkFBb0J6QixVQUFwQixFQUFtQ2dCLE9BQU9ZLGFBQVAsQ0FBcUJDLE9BQXhEO0FBQ0FKLG9CQUFvQnhCLFNBQXBCLEVBQWtDZSxPQUFPWSxhQUFQLENBQXFCQyxPQUF2RCIsImZpbGUiOiJ1aS9hc3NldHMvb3ZlcnZpZXcuanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBidG5FeHBvcnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZXhwb3J0IGJ1dHRvbicpO1xuY29uc3QgYnRuUmVwbGFjZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5yZXBsYWNlIGJ1dHRvbicpO1xuY29uc3QgYnRuU3dpdGNoID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnN3aXRjaCBidXR0b24nKTtcbmNvbnN0IHN1Y2Nlc3NLZXkgPSAnZ3gtYWRtaW46c2VuZC1pbmZvLWJveC1zdWNjZXNzLW1lc3NhZ2UnO1xuY29uc3Qgd2FybmluZ0tleSA9ICdneC1hZG1pbjpzZW5kLWluZm8tYm94LXdhcm5pbmctbWVzc2FnZSc7XG5cbmZ1bmN0aW9uIGhhbmRsZUNsaWNrKGV2ZW50LCBjYWxsYmFja1VybCkge1xuXHRjb25zdCBidG4gPSBldmVudC50YXJnZXQ7XG5cdGNvbnN0IHJlcXVlc3QgPSBmZXRjaChjYWxsYmFja1VybCwge1xuXHRcdG1ldGhvZDogJ3Bvc3QnXG5cdH0pO1xuXHRidG4uc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsIHRydWUpO1xuXG5cdHJlcXVlc3QudGhlbihyZXNwb25zZSA9PiB7XG5cdFx0aWYgKHJlc3BvbnNlLm9rKSB7XG5cdFx0XHR3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoc3VjY2Vzc0tleSkpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQod2FybmluZ0tleSwge1xuXHRcdFx0XHRkZXRhaWw6IHtcblx0XHRcdFx0XHR0aXRsZTogJ1JlcXVlc3QgZmFpbGVkJyxcblx0XHRcdFx0XHRtZXNzYWdlOiAnQ291bGQgbm90IHBlcmZvcm0gcmVxdWVzdGVkIGFjdGlvbi4nXG5cdFx0XHRcdH1cblx0XHRcdH0pKVxuXHRcdH1cblx0fSkuZmluYWxseSgoKSA9PiB7XG5cdFx0YnRuLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcblx0fSk7XG59XG5cbmZ1bmN0aW9uIGFkZENhbGxiYWNrTGlzdGVuZXIoYnV0dG9uLCBjYWxsYmFja1VybCkge1xuXHRidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBldmVudCA9PiB7XG5cdFx0aGFuZGxlQ2xpY2soZXZlbnQsIGNhbGxiYWNrVXJsKTtcblx0fSk7XG59XG5cbmFkZENhbGxiYWNrTGlzdGVuZXIoYnRuRXhwb3J0LCBgJHt3aW5kb3cuanNFbnZpcm9ubWVudC5iYXNlVXJsfS9hZG1pbi9tYWthaXJhL2dhbWJpby1jb25uZWN0L3N5bmMvZXhwb3J0YCk7XG5hZGRDYWxsYmFja0xpc3RlbmVyKGJ0blJlcGxhY2UsIGAke3dpbmRvdy5qc0Vudmlyb25tZW50LmJhc2VVcmx9L2FkbWluL21ha2FpcmEvZ2FtYmlvLWNvbm5lY3Qvc3luYy9yZXBsYWNlYCk7XG5hZGRDYWxsYmFja0xpc3RlbmVyKGJ0blN3aXRjaCwgYCR7d2luZG93LmpzRW52aXJvbm1lbnQuYmFzZVVybH0vYWRtaW4vbWFrYWlyYS9nYW1iaW8tY29ubmVjdC9zeW5jL3N3aXRjaGApO1xuIl19
